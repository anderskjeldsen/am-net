namespace SocketTest {
    class Program {
        import Am.Lang
        import Am.IO
        import Am.Net

        static fun main() {
            "connect to localhost".println()
            var s = Socket.create(AddressFamily.inet, SocketType.stream, ProtocolFamily.unspecified)
            s.connect("localhost", 8080)
            "connected".println()

            var socketStream = new SocketStream(s)
            var istream = socketStream as Stream
            var ts = new TextStream(istream)
            ts.writeString("GET / HTTP/1.1\r\nHost:localhost\r\n\r\n")

            var rs = ts.readString()
            rs.println()        
            s.close()    
        }
    }
}